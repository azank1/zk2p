# ✅ Build Error Fixed! Copy and paste these commands in WSL

# Navigate to project
cd /mnt/d/dev/zk2p/anomi-zk-prototype

# Build programs (OrderBook size fix + payment status tracking)
anchor build

# Expected output:
#   Compiling market v0.1.0
#   Compiling order-store v0.1.0
#   Compiling order-processor v0.1.0
#   Finished release [optimized]

# Deploy to devnet
anchor deploy --provider.cluster devnet

# Expected output:
#   Deploying cluster: https://api.devnet.solana.com
#   Program Id: Bk2pKQsXXvjPChX2G8AWgwoefnwRbTSirtHGnG8yUEdB
#   Deploy success

# Initialize market (use existing token from earlier test)
npm run p2p:init-market FRBYvn9SBFNptrDm9enMFEKNxMPkqxztoLbpbcmj2Pzb

# Expected output:
#   [1/3] Initializing escrow vault...
#   ✓ Escrow vault initialized
#   [2/3] Initializing market...
#   ✓ Market initialized
#   [3/3] Initializing order book...
#   ✓ Order book initialized  ← KEY SUCCESS!

# Run P2P swap test
npm run p2p:test

# Expected output:
#   ✅ Ask placed! TX: <SIGNATURE>
#   ✅ Bid placed! TX: <SIGNATURE>
#   === P2P Test Complete ===

# Verify order book state
npm run p2p:fetch

# Start UI server for 2-wallet testing
npm run ui:start

# Then open in browsers:
# http://127.0.0.1:8080

# ========================================
# WHAT WAS FIXED:
# ========================================
# 1. OrderBook INIT_SPACE: 2764 bytes (was exceeding 10KB)
# 2. order-store seeds: Added .as_ref() for proper type
# 3. Payment status tracking: New fields in Order struct
# 4. Settlement instructions: mark_payment_made, verify_settlement
# 5. UI enhancements: Payment section, 10s timer, wallet roles

